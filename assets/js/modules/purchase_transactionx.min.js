function gen_kdsp(a){$.get(baseurl+"get_sp_id/"+a,function(a,e){$("#add_supplier_form #Kode").prop("value",a)})}function gen_kdbarang(a){$.get(baseurl+"get_kdbarang/"+a,function(a,e){$("#form_barang #Kode").prop("value",a)})}function generate_kdbarang(){$("#form_barang #id_supplier").val()}function save_supplier(a){var e=$("form#add_supplier_form").serializeArray();e.push({name:"ajax",value:1}),$(this).ready(function(){$.ajax({url:spurl+"submit/"+a,data:e,type:"POST",success:function(a){var e=JSON.parse(a);$("#id_supplier").append($("<option></option>").val(e.id_supplier).html(e.Kode+" ("+e.Nama+")")),$("#id_supplier").find("option[value="+e.id_supplier+"]").prop({selected:!0,disabled:!1})}})})}function save_barang(a){var e=$("form#form_barang").serializeArray();e.push({name:"ajax",value:1}),$(this).ready(function(){$.ajax({url:brgurl+"submit"+a,data:e,type:"POST",success:function(a){var e=JSON.parse(a);$("#Kode").find("option[value="+e.id+"]").prop({selected:!0,disabled:!1})}})})}function reset_barang(a){var e=$("#id_supplier").val();get_barang(e)}function get_barang(a){$("select#Kode option").remove(),$.getJSON(pourl+"get_drop_barang/"+a,function(a){$.each(a,function(a,e){$("#Kode").append($("<option></option>").val(a).html(e))})})}function get_satuan(a){$("select#Satuan option").remove(),$.getJSON(pourl+"/dropdown_satuan/"+a,function(a){$.each(a,function(a,e){$("#Satuan").append($("<option></option>").val(a).html(e))})})}function hitung(){var a=accounting.unformat($("#totalbayarx").val())>0?accounting.unformat($("#totalbayarx").val()):0,e=$("#ppn").val()>0?$("#ppn").val():0,n=$("#biayakirim").val()>0?$("#biayakirim").val():0;gtotalppn=parseFloat(a)+parseFloat(e/100*parseFloat(a)),gtotal=gtotalppn+parseFloat(n),$("#grandtotal").prop("value",gtotal),$("#grandtotalx").prop("value",accounting.formatMoney(gtotal,"Rp",2));var t=$("#uangmuka").val()>0?$("#uangmuka").val():0,o=gtotal-parseFloat(t);$("#sisa").prop("value",accounting.formatMoney(o,"Rp",2))}function get_po(a){$.get(pourl+"get/"+a,function(a){var e=JSON.parse(a),n=e.id_supplier;$("#id_supplier").find("option[value="+n+"]").prop({selected:!0,disabled:!1}),$("#id_supplier option:not(:selected)").attr("disabled",!0),$("#totalbayar").prop("value",e.totalbayar),$("#totalbayarx").prop("value",accounting.formatMoney(e.totalbayar,"Rp",2))})}function get_supplier(){$.get(baseurl+"get_dropdown_supplier/",function(a){$.each(a,function(a,e){$("#id_supplier").append($("<option></option>").val(a).html(e))})})}function new_faktur(){$.get(baseurl+"get_new_pt/",function(a,e){$("#faktur_pt").prop("value",a)})}$("document").ready(function(){var a=$("#faktur_pt").val();$("body").on("change","#id_tipe_beli",function(){"2"==$(this).val()?($(".panel_tambah").fadeOut(200),$("#bypo").fadeIn(200)):($(".panel_tambah").fadeIn(200),$("#bypo").fadeOut(200))}),$("body").on("change","#id_supplier",function(){var a=$("#id_tipe_beli");"1"==a&&reset_barang(enkrip)}),$("#id_supplier").change(function(){var a=$(this).val();get_barang(a)}),$("#Kode").change(function(){var a=$(this).val();get_satuan(a)});var e=$("#data").DataTable({ajax:{url:baseurl+"pt_detail/"+enkrip+"/"+a,dataType:"json"},sServerMethod:"POST",bServerSide:!0,paging:!1,deferRender:!0,bFilter:!1,ordering:!1});$("#modal-id").on("shown.bs.modal",function(a){$("#datax.tabelpo").DataTable({ajax:{url:baseurl+"getdatapo",dataType:"json"},sServerMethod:"POST",bServerSide:!0})}),$("body").on("click","[data-load-faktur]",function(a){a.preventDefault();var n=$(this),t=n.data("load-faktur"),o=n.data("faktur"),r=$(this).attr("id"),p=baseurl+"get_po_detail/"+o+"/"+enkrip+"/";t&&($("#faktur_po").prop("value",o),$("#faktur_po").prop("readonly",!0),$("#id_po").prop("value",r),e.ajax.url(p).load()),get_po(r)}),$("body").on("click",".generate_pt",function(a){a.preventDefault(),new_faktur()}),$("body").on("click",".baru",function(a){a.preventDefault(),new_faktur()}),$("body").on("click","#save_supplier",function(a){a.preventDefault(),save_supplier(enkrip)}),$("body").on("click","#save_barang",function(a){a.preventDefault(),save_barang(enkrip),reset_barang(enkrip)}),$("body").on("click",".gen_kdsp",function(a){a.preventDefault(),gen_kdsp(enkrip)}),$("body").on("click",".refresh_barang",function(a){a.preventDefault(),reset_barang()}),$("#modal-form").on("shown.bs.modal",function(a){gen_kdsp(enkrip)}),$("#modal-barang").on("shown.bs.modal",function(a){var e=$("#id_supplier").val();$.get(spurl+"get/"+e+"/"+enkrip,function(a,e){var n=JSON.parse(a);$("form#form_barang #id_supplier").find("option[value="+n.Kode+"]").prop({selected:!0,disabled:!1})})}),$("body").on("change","#form_barang #id_golongan",function(a){a.preventDefault();var e=$("#form_barang #id_golongan").val();$.get(jnsbrgurl+"get_new_jenis/"+enkrip+"/"+e+"/",function(a,e){$("#form_barang #Kode").prop("value",a)})})});