function gen_kdsp(a){$.get(pturl+"get_sp_id/"+a,function(a,e){$("#add_supplier_form #Kode").prop("value",a)})}function gen_kdbarang(a){$.get(pturl+"get_kdbarang/"+a,function(a,e){$("#form_barang #Kode").prop("value",a)})}function generate_kdbarang(){$("#form_barang #id_supplier").val()}function save_supplier(a){var e=$("form#add_supplier_form").serializeArray();e.push({name:"ajax",value:1}),$(this).ready(function(){$.ajax({url:spurl+"submit/"+a,data:e,type:"POST",success:function(a){var e=JSON.parse(a);$("#id_supplier").append($("<option></option>").val(e.id_supplier).html(e.Kode+" ("+e.Nama+")")),$("#id_supplier").find("option[value="+e.id_supplier+"]").prop({selected:!0,disabled:!1})}})})}function save_barang(a){var e=$("form#form_barang").serializeArray();e.push({name:"ajax",value:1}),$(this).ready(function(){$.ajax({url:brgurl+"submit/"+a,data:e,type:"POST",success:function(a){var e=JSON.parse(a);$("#Kode").find("option[value="+e.id+"]").prop({selected:!0,disabled:!1})}})})}function gettotal(){var a=$("#faktur_po").val();$.get(baseurl+"get_po_detail_total/"+a,function(a,e){a>0?($("#totalbayar").val(a),$("#totalbayarx").val(accounting.formatMoney(a,"Rp ",2))):($("#totalbayar").val(0),$("#totalbayarx").val(0))})}function reset_barang(){var a=$("#id_supplier").val();get_barang(a)}function new_faktur(){$.get(baseurl+"get_new_po/",function(a,e){$("#faktur_po").prop("value",a)})}function get_satuan(a){$("select#Satuan option").remove(),$.getJSON(baseurl+"dropdown_satuan/"+a,function(a){$.each(a,function(a,e){$("#Satuan").append($("<option></option>").val(a).html(e))})})}function get_barang(a){$("select#Kode option").remove(),$.getJSON(baseurl+"get_drop_barang/"+a,function(a){$.each(a,function(a,e){$("#Kode").append($("<option></option>").val(a).html(e))})})}$(document).ready(function(){$("#id_supplier").change(function(){var a=$(this).val();get_barang(a)}),$("#Kode").change(function(){var a=$(this).val(),e=brgsatuurl+"getsatuan/"+a+"/";$("#addsatuan").attr("href",e),get_satuan(a)});var a=$("#faktur_po").val(),e=$(".tabletemp").DataTable({ajax:{url:baseurl+"get_po_detail/"+a+"/"+enkrip,dataType:"json"},sServerMethod:"POST",bServerSide:!0,bAutoWidth:!0,SortClasses:!0,bscrollCollapse:!0,paging:!1,deferRender:!0,bFilter:!1,ordering:!1});$("body").on("click",".generate_po",function(a){a.preventDefault(),new_faktur()}),$("body").on("click",".refresh_barang",function(a){a.preventDefault(),reset_barang()}),$("body").on("click",".btn-add",function(a){a.preventDefault();var n=($("#faktur_po").val(),$("#Kode").val()),t=$("#Qty").val(),o=$("#Satuan").val(),r={id_barang:n,jumlah:t,id_satuan:o,faktur_po:$("#faktur_po").val(),ajax:1};$(this).ready(function(){$.ajax({url:baseurl+"submit_detail",data:r,type:"POST",success:function(a){$("#Kode").prop("value",""),$("#Qty").prop("value",""),$("#Satuan").prop("value",""),$("#Satuan option").prop("selected",function(){return this.defaultSelected}),$("#Kode option").prop("selected",function(){return this.defaultSelected}),e.clear(0).draw(),gettotal()}})})}),$("body").on("click",".delete_temp",function(a){a.preventDefault();var n={id:$(this).attr("id"),ajax:1};confirm("Anda Yakin Ingin Menghapus Item Ini?")&&$(this).ready(function(){$.ajax({url:baseurl+"delete_detail",type:"POST",data:n,success:function(a){e.clear(0).draw(),gettotal()}})})}),gettotal(),$("#modal-notif").on("hidden.bs.modal",function(){$(this).data("modal",null),window.location=baseurl}),$("body").on("click","#save_supplier",function(a){a.preventDefault(),save_supplier(enkrip)}),$("body").on("click","#save_barang",function(a){a.preventDefault(),save_barang(enkrip),reset_barang(enkrip)}),$("body").on("click",".gen_kdsp",function(a){a.preventDefault(),gen_kdsp(enkrip)}),$("#modal-form").on("shown.bs.modal",function(a){gen_kdsp(enkrip)}),$("#modal-barang").on("shown.bs.modal",function(a){var e=$("#id_supplier").val();$.get(spurl+"get/"+e+"/"+enkrip,function(a,e){var n=JSON.parse(a);$("form#form_barang #id_supplier").find("option[value="+n.Kode+"]").prop({selected:!0,disabled:!1})})}),$("body").on("change","#form_barang #id_golongan",function(a){a.preventDefault();var e=$("#form_barang #id_golongan").val();$.get(jnsbrgurl+"get_new_jenis/"+enkrip+"/"+e+"/",function(a,e){$("#form_barang #Kode").prop("value",a)})})});